@using  ShoppingAgain.Models;

@model ShoppingList
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ShoppingList current = Model;
    ViewBag.title = current.Name;
}

<table>
    <thead>
        <tr>
            <th>Name</th>
            <th>Controls</th>
        </tr>
    </thead>
    <tbody class="items" id="list">
        <tr id="list-tr-template" hidden>
            <td></td>
            <td class="controls">
                <form class="state-form" method="post" action="">
                    <button class="state" type="submit"><img /></button>
                </form>
                <form class="delete-form" method="post" action="">
                    <button class="state" type="submit"><img /></button>
                </form>
                <form method="post" action="">
                    <button class="state" type="submit"><img /></button>
                </form>

            </td>
        </tr>
        @foreach (Item i in current.Items)
        {
            <tr id="@i.ID">
                <td>@i.Name</td>
                <td class="controls">
                    <form method="post" asp-route="@StaticNames.ItemNextState" asp-route-listId="@Model.ID" asp-route-itemId="@i.ID">
                        <button class="state" type="submit"><state s="@i.State"></button>
                    </form>
                    <form method="post" asp-route="@StaticNames.ItemChangeName" asp-route-listId="@Model.ID" asp-route-itemId="@i.ID">
                        <button class="state" type="submit"><icon src="~/images/edit.svg"></button>
                    </form>
                    <form method="post" asp-route="@StaticNames.ItemDelete" asp-route-listId="@Model.ID" asp-route-itemId="@i.ID">
                        <button class="state" type="submit"><icon src="~/images/trash.svg"></button>
                    </form>
                </td>
            </tr>
        }
    </tbody>
    <tfoot>
        <tr id="list-controls">
            <td>
                <input form="ItemCreate" name="name" placeholder="New Item Name" required />
            </td>
            <td>
                <form id="ItemCreate" method="post" asp-route="@StaticNames.ItemCreate" asp-route-listId="@Model.ID">
                    <button type="submit">Add Item</button>
                </form>
            </td>
        </tr>

    </tfoot>
</table>
<p>
    <a href="@Url.RouteUrl(StaticNames.ListEdit, new { listId = current.ID })">Change the name of the list</a>
    |
    <a href="@Url.RouteUrl(StaticNames.ListDelete, new { listId = current.ID })">Delete this list</a>
</p>
@section scripts  {
    <script nonce="@ViewBag.Nonce">
        const currentList = "@current.ID";
    </script>

}
